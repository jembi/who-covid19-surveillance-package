{
  "name": "FHIR - Orchestrate Composition Data into one resource",
  "description": "",
  "endpoint": {
    "pattern": "/create-composition"
  },
  "transformation": {
    "input": "JSON",
    "output": "JSON"
  },
  "inputTransforms": {
    "createDate": "$substringBefore( $now(), 'T')",
    "compositionId": "'urn:uid:' & $substringAfter($string($random()), '0.')"
  },
  "inputMapping": {
    "constants.template": "composition",
    "transforms.compositionId": "composition.fullUrl",
    "requestBody.author": "composition.resource.author[]+",
    "requestBody.identifier": "composition.resource.identifier.value",
    "transforms.createDate": "composition.resource.date"
  },
  "constants": {
    "template": {
      "resource": {
        "resourceType": "Composition",
        "type": {
          "coding": [
            {
              "code": "95412-3",
              "system": "http://loinc.org"
            }
          ]
        },
        "status": "final",
        "identifier": {
          "system": "http://test.org/identifier/who-covid-19-case-report"
        },
        "encounter": {},
        "author": [],
        "title": "WHO COVID-19 Case Report"
      }
    }
  }
}
